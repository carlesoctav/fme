[Mine with dropout]
my implememtnation
fp32 batchsize 64 dp 4 with dropout
compile time: 210 sec, 
Total memory size: 8.0 GB, Output size: 1.2 GB, Temp size: 5.5 GB, Argument size: 1.2 GB, Host temp size: 0.0 GB.

[Mine no dropout]
my implememtnation
fp32 batchsize 64 dp 4 with dropout
compile time: 50s sec, 
Total memory size: 8.0 GB, Output size: 1.2 GB, Temp size: 5.5 GB, Argument size: 1.2 GB, Host temp size: 0.0 GB.



[flax no dropoput]
DEBUGPRINT[12]: train_with_flax.py:254: diff_dp=0.07424728572368622
DEBUGPRINT[9]: train_with_flax.py:190: diff for compile=39.273700847290456
DEBUGPRINT[11]: train_with_flax.py:198: compiled=<jax._src.stages.Compiled object at 0x7ff4b61cd430>
Total memory size: 8.5 GB, Output size: 1.5 GB, Temp size: 5.6 GB, Argument size: 1.5 GB, Host temp size: 0.0 GB.
/home/carlesoctav/.pyenv/versions/3.11.13/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 4 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '

[flax with dropout] 
DEBUGPRINT[12]: train_with_flax.py:254: diff_dp=0.07411471614614129
DEBUGPRINT[9]: train_with_flax.py:190: diff for compile=84.04566059680656
DEBUGPRINT[11]: train_with_flax.py:198: compiled=<jax._src.stages.Compiled object at 0x7f192208f7d0>
Total memory size: 8.5 GB, Output size: 1.5 GB, Temp size: 5.6 GB, Argument size: 1.5 GB, Host temp size: 0.0 GB.
/home/carlesoctav/.pyenv/versions/3.11.13/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 4 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
